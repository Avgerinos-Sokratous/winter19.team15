<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <script src="jquery-1.10.2.min.js" type="text/javascript"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.7.7/xlsx.core.min.js"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.core.min.js"></script> 
    <!-- Latest compiled JavaScript -->
    <script>
    $(function () {
    $("#includedContent").load("http://cproject.in.cs.ucy.ac.cy/ironsky/winter19.team15/navbarclient.html");
    });
    </script>
    <title>Ironsky Fitness</title>
    <link rel="shortcut icon" href="images/ironsky2.png" type="image/png">
    <!--<link href="css/main.css" rel="stylesheet">   -->
    <link href="css/table.css" rel="stylesheet">
    <!-- MATERIAL DESIGN ICONIC FONT -->
		<link rel="stylesheet" href="fonts/material-design-iconic-font/css/material-design-iconic-font.css">

		<!-- DATE-PICKER -->
		<link rel="stylesheet" href="vendor/date-picker/css/datepicker.min.css">

		<!-- STYLE CSS -->
		<link rel="stylesheet" href="css/style.css">
</head>

<body style="background-color:#1E4072;" onload="XLStoPDF()">
<!-- START OF NAVIGATION BAR -->

    <div id="includedContent"></div>
    <!-- END OF NAVIGATION BAR -->
    <br>
    <div class="form-gap">
        <h4 class="logo ml-4 text-white">
            I R O N S K Y<br>
            <span>FITNESS</span>
        </h4>
    </div>
    <div class="container py-5">
        <div class="row">
            <div class="col-12 mx-auto">
  <!--                      <input type="file" id="excelfile" />  
   <input type="button" id="viewfile" value="Export To Table" onclick="ExportToTable()" />  
      <br />  
      <br />  
   <table id="exceltable" class="table table-bordered table-stripped table-responsive">  
</table>          

    <embed src="nutr.pdf" width="1000px" height="1000px"/>   -->
            <div class="wrapper">
            <form action="" id="wizard">
        		<!-- SECTION 1 -->
                <h4></h4>
                <section>
                    <div class="inner">
						<div class="image-holder">
							<img src="images/form-wizard-1.jpg" alt="">
						</div>
						<div class="form-content">
							<div class="form-inner">
								<div class="form-header">
									<h3>Book a table</h3>
									<p>~ Check out our place ~</p>
								</div>
								<div class="form-row" style="margin-bottom: 31px;">
									<label for="">
										<i class="zmdi zmdi-account-o"></i>
										People
									</label>
									<div class="select">
										<div class="form-holder">
											<div class="select-control"></div>
											<i class="zmdi zmdi-chevron-down"></i>
										</div>
										<ul class="dropdown">
											<li rel="1">1</li>
											<li rel="2">2</li>
											<li rel="3">3</li>
											<li rel="4">4</li>
											<li rel="5">5</li>
										</ul>
									</div>
								</div>
								<div class="form-row" style="margin-bottom: 31px;">
									<label for="">
										<i class="zmdi zmdi-calendar-check"></i>
										Date
									</label>
									<input type='text' class='datepicker-here form-control' data-language='en' id="dp" data-date-format="dd M yyyy"/>
								</div>
								<div class="form-row">
									<label for="" style="margin-bottom: 9px;">
										<i class="zmdi zmdi-alarm"></i>
										Time
									</label>
									<div class="form-holder select-holder">
										<select name="" id="" class="form-control">
											<option value="9am"><span>9</span> am</option>
											<option value="10am"><span>10</span> am</option>
											<option value="11am"><span>11</span>am</option>
											<option value="12am"><span>12</span>am</option>
										</select>
										<i class="zmdi zmdi-caret-down"></i>
									</div>
									<div class="form-holder select-holder">
										<select name="" id="" class="form-control">
											<option value="7pm"><span>7</span> pm</option>
											<option value="8pm"><span>8</span> pm</option>
											<option value="9pm"><span>9</span> pm</option>
											<option value="10pm"><span>10</span> pm</option>
										</select>
										<i class="zmdi zmdi-caret-down"></i>
									</div>
								</div>
							</div>
						</div>
					</div>
                </section>
                
				<!-- SECTION 2 -->
                <h4></h4>
                <section>
     				<div class="inner">
						<div class="image-holder">
							<img src="images/form-wizard-2.jpg" alt="">
						</div>
						<div class="form-content">
							<div class="form-inner">
								<div class="form-header">
									<h3>Contact details</h3>
									<p>~ Check out our place ~</p>
								</div>
								<div class="form-row">
									<label for="">
										<i class="zmdi zmdi-account-o"></i>
										Name
									</label>
									<input type="text" class="form-control" placeholder="Name">
								</div>
								<div class="form-row">
									<label for="">
										<i class="zmdi zmdi-phone"></i>
										Phone
									</label>
									<input type="text" class="form-control" placeholder="My phone">
								</div>
								<div class="form-row">
									<label for="">
										<i class="zmdi zmdi-email"></i>
										Email
									</label>
									<input type="text" class="form-control" placeholder="Your Email">
								</div>
							</div>
						</div>
					</div>
                </section>

                <!-- SECTION 3 -->
                <h4></h4>
                <section>
                    <div class="inner">
						<div class="image-holder">
							<img src="images/form-wizard-3.jpg" alt="">
						</div>
						<div class="form-content">
							<div class="form-inner form-inner-last">
								<div class="ready">
									<span>
										<i class="zmdi zmdi-check"></i>
									</span>
									<p class="text-1">Your table is ready</p>
									<p class="text-2">~ Happy friends with a say ~</p>
								</div>
							</div>
						</div>
					</div>
                </section>
            </form>
		</div>
            </div>
        </div>
    </div>
  </body>
  <script>
  function ExportToTable() {  
     var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xlsx|.xls)$/;  
     /*Checks whether the file is a valid excel file*/  
     if (regex.test($("#excelfile").val().toLowerCase())) {  
         var xlsxflag = false; /*Flag for checking whether excel is .xls format or .xlsx format*/  
         if ($("#excelfile").val().toLowerCase().indexOf(".xlsx") > 0) {  
             xlsxflag = true;  
         }  
         /*Checks whether the browser supports HTML5*/  
         if (typeof (FileReader) != "undefined") {  
             var reader = new FileReader();  
             reader.onload = function (e) {  
                 var data = e.target.result;  
                 /*Converts the excel data in to object*/  
                 if (xlsxflag) {  
                     var workbook = XLSX.read(data, { type: 'binary' });  
                 }  
                 else {  
                     var workbook = XLS.read(data, { type: 'binary' });  
                 }  
                 /*Gets all the sheetnames of excel in to a variable*/  
                 var sheet_name_list = workbook.SheetNames;  
  
                 var cnt = 0; /*This is used for restricting the script to consider only first sheet of excel*/  
                 sheet_name_list.forEach(function (y) { /*Iterate through all sheets*/  
                     /*Convert the cell value to Json*/  
                     if (xlsxflag) {  
                         var exceljson = XLSX.utils.sheet_to_json(workbook.Sheets[y]);  
                     }  
                     else {  
                         var exceljson = XLS.utils.sheet_to_row_object_array(workbook.Sheets[y]);  
                     }  
                     if (exceljson.length > 0 && cnt == 0) {  
                         BindTable(exceljson, '#exceltable');  
                         cnt++;  
                     }  
                 });  
                 $('#exceltable').show();  
             }  
             if (xlsxflag) {/*If excel file is .xlsx extension than creates a Array Buffer from excel*/  
                 reader.readAsArrayBuffer($("#excelfile")[0].files[0]);  
             }  
             else {  
                 reader.readAsBinaryString($("#excelfile")[0].files[0]);  
             }  
         }  
         else {  
             alert("Sorry! Your browser does not support HTML5!");  
         }  
     }  
     else {  
         alert("Please upload a valid Excel file!");  
     }  
 }  
 function BindTable(jsondata, tableid) {/*Function used to convert the JSON array to Html Table*/  
     var columns = BindTableHeader(jsondata, tableid); /*Gets all the column headings of Excel*/  
     for (var i = 0; i < jsondata.length; i++) {  
         var row$ = $('<tr/>');  
         for (var colIndex = 0; colIndex < columns.length; colIndex++) {  
             var cellValue = jsondata[i][columns[colIndex]];  
             if (cellValue == null)
                 cellValue = "";  
                 
             row$.append($('<td/>').html(cellValue));  
         }  
         $(tableid).append(row$);  
     }  
 }  
 function BindTableHeader(jsondata, tableid) {/*Function used to get all column names from JSON and bind the html table header*/  
     var columnSet = [];  
     var headerTr$ = $('<tr/>');  
     for (var i = 0; i < jsondata.length; i++) {  
         var rowHash = jsondata[i];  
         for (var key in rowHash) {  
             if (rowHash.hasOwnProperty(key)) {  
                 if ($.inArray(key, columnSet) == -1) {/*Adding each unique column names to a variable array*/  
                     columnSet.push(key);  
                     headerTr$.append($('<th/>').html(key));  
                 }  
             }  
         }  
     }  
     $(tableid).append(headerTr$);  
     return columnSet;  
 } 
 
 function XLStoPDF(){
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var docPath = "nutr.xlsx";
    docPath = fso.GetAbsolutePathName(docPath);
    
    var pdfPath = docPath.replace(/\.xls[^.]*$/, ".pdf");
    var objExcel = null;
    
    try
    {
        //WScript.Echo("Saving '" + docPath + "' as '" + pdfPath + "'...");
    
        objExcel = new ActiveXObject("Excel.Application");
        objExcel.Visible = false;
    
        var objWorkbook = objExcel.Workbooks.Open(docPath);

        var wdFormatPdf = 57;
        objWorkbook.SaveAs(pdfPath, wdFormatPdf);
        objWorkbook.Close();
    
       // WScript.Echo("Done.");
    }
    finally
    {
        if (objExcel != null)
        {
            objExcel.Quit();
        }
    }
 }
 </script>
</html>
